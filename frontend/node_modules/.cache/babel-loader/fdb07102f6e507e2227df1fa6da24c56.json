{"ast":null,"code":"import _asyncToGenerator from\"D:/D\\u1EF1 \\xC1n T\\u1ED1t Nghi\\u1EC7p/duantotnghiep_test/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/D\\u1EF1 \\xC1n T\\u1ED1t Nghi\\u1EC7p/duantotnghiep_test/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:/D\\u1EF1 \\xC1n T\\u1ED1t Nghi\\u1EC7p/duantotnghiep_test/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState}from'react';import CategoryContext from'./categoryContext';import axios from'axios';// Function for cleaning null, undefined and empty strings values in objects\nimport{jsx as _jsx}from\"react/jsx-runtime\";function clean(obj){for(var propName in obj){if(obj[propName]===null||obj[propName]===undefined||obj[propName]===''){delete obj[propName];}}return obj;}// ------------------------------------------\n// Category State\n// ------------------------------------------\nvar CategoryState=function CategoryState(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),categories=_useState2[0],setCategories=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),categoriesError=_useState4[0],setCategoriesError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),categoriesLoading=_useState6[0],setCategoriesLoading=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),categoriesMessage=_useState8[0],setCategoriesMessage=_useState8[1];useEffect(function(){setTimeout(function(){setCategoriesError(null);setCategoriesMessage(null);},3000);},[categoriesError,categoriesMessage]);// Error Handler function\nvar errorHandler=function errorHandler(err,info){if(err.response){setCategoriesError({variant:'danger',message:\"\".concat(info,\", \").concat(err.response.data.error)});}else if(err.request){setCategoriesError({variant:'danger',message:\"\".concat(info,\",  Kh\\xF4ng c\\xF3 ph\\u1EA3n h\\u1ED3i t\\u1EEB m\\xE1y ch\\u1EE7!\")});}else{setCategoriesError({variant:'danger',message:err.message});}setCategoriesLoading(false);};// Add new category\nvar addCategory=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(title){var categoryBody,userToken,headers;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:categoryBody=clean({title:title});console.log(categoryBody,' categoryBody');_context.prev=2;userToken=JSON.parse(localStorage.getItem('userToken'));headers={Authorization:\"Bearer \".concat(userToken&&userToken)};setCategoriesLoading(true);_context.next=8;return axios.post('api/category/add',categoryBody,{headers:headers});case 8:// setCategories([...categories, categoryBody])\nsetCategoriesMessage({variant:'success',message:'Danh mục được thêm thành công!'});window.location.reload();setCategoriesLoading(false);setCategoriesError(null);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](2);errorHandler(_context.t0);case 17:case\"end\":return _context.stop();}}},_callee,null,[[2,14]]);}));return function addCategory(_x){return _ref.apply(this,arguments);};}();// get all categories\nvar getCategories=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setCategoriesLoading(true);_context2.next=4;return axios.get('api/category/getAll');case 4:_yield$axios$get=_context2.sent;data=_yield$axios$get.data;setCategories(data.categories);setCategoriesLoading(false);setCategoriesError(null);_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);errorHandler(_context2.t0);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11]]);}));return function getCategories(){return _ref2.apply(this,arguments);};}();// Delete Category\nvar deleteCategory=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){var userToken,headers,_yield$axios$delete,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;setCategoriesLoading(true);userToken=JSON.parse(localStorage.getItem('userToken'));headers={Authorization:\"Bearer \".concat(userToken&&userToken),'Content-Type':'multipart/form-data'};_context3.next=6;return axios.delete(\"/api/category/\".concat(id),{headers:headers});case 6:_yield$axios$delete=_context3.sent;data=_yield$axios$delete.data;setCategoriesMessage({variant:'success',message:'Xóa thành công!'});window.location.reload();setCategoriesLoading(false);setCategoriesError(null);return _context3.abrupt(\"return\",data.categories);case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](0);errorHandler(_context3.t0,'Không tìm thấy sản phẩm');case 18:case\"end\":return _context3.stop();}}},_callee3,null,[[0,15]]);}));return function deleteCategory(_x2){return _ref3.apply(this,arguments);};}();// get one category\nvar getOneCategory=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id){var _yield$axios$get2,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return axios.get(\"/api/category/\".concat(id));case 3:_yield$axios$get2=_context4.sent;data=_yield$axios$get2.data;return _context4.abrupt(\"return\",data.categories);case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](0);errorHandler(_context4.t0);case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[0,8]]);}));return function getOneCategory(_x3){return _ref4.apply(this,arguments);};}();var updateCategory=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(id,title){var userToken,headers;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;userToken=JSON.parse(localStorage.getItem('userToken'));headers={Authorization:\"Bearer \".concat(userToken&&userToken)};setCategoriesLoading(true);_context5.next=6;return axios.patch(\"api/category/\".concat(id),{title:title},{headers:headers});case 6:getCategories();setCategoriesMessage({variant:'info',message:'Danh mục được cập nhật!'});setCategoriesLoading(false);setCategoriesError(null);_context5.next=15;break;case 12:_context5.prev=12;_context5.t0=_context5[\"catch\"](0);errorHandler(_context5.t0);case 15:case\"end\":return _context5.stop();}}},_callee5,null,[[0,12]]);}));return function updateCategory(_x4,_x5){return _ref5.apply(this,arguments);};}();return/*#__PURE__*/_jsx(CategoryContext.Provider,{value:{categories:categories,categoriesError:categoriesError,categoriesLoading:categoriesLoading,categoriesMessage:categoriesMessage,getCategories:getCategories,addCategory:addCategory,deleteCategory:deleteCategory,getOneCategory:getOneCategory,updateCategory:updateCategory},children:props.children});};export default CategoryState;","map":{"version":3,"names":["React","useEffect","useState","CategoryContext","axios","clean","obj","propName","undefined","CategoryState","props","categories","setCategories","categoriesError","setCategoriesError","categoriesLoading","setCategoriesLoading","categoriesMessage","setCategoriesMessage","setTimeout","errorHandler","err","info","response","variant","message","data","error","request","addCategory","title","categoryBody","console","log","userToken","JSON","parse","localStorage","getItem","headers","Authorization","post","window","location","reload","getCategories","get","deleteCategory","id","delete","getOneCategory","updateCategory","patch","children"],"sources":["D:/Dự Án Tốt Nghiệp/duantotnghiep_test/frontend/src/context/category/CategoryState.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport CategoryContext from './categoryContext'\r\nimport axios from 'axios'\r\n\r\n// Function for cleaning null, undefined and empty strings values in objects\r\nfunction clean(obj) {\r\n  for (var propName in obj) {\r\n    if (\r\n      obj[propName] === null ||\r\n      obj[propName] === undefined ||\r\n      obj[propName] === ''\r\n    ) {\r\n      delete obj[propName]\r\n    }\r\n  }\r\n  return obj\r\n}\r\n\r\n// ------------------------------------------\r\n// Category State\r\n// ------------------------------------------\r\nconst CategoryState = props => {\r\n  const [categories, setCategories] = useState([])\r\n  const [categoriesError, setCategoriesError] = useState(null)\r\n  const [categoriesLoading, setCategoriesLoading] = useState(false)\r\n  const [categoriesMessage, setCategoriesMessage] = useState(null)\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      setCategoriesError(null)\r\n      setCategoriesMessage(null)\r\n    }, 3000)\r\n  }, [categoriesError, categoriesMessage])\r\n\r\n  // Error Handler function\r\n  const errorHandler = (err, info) => {\r\n    if (err.response) {\r\n      setCategoriesError({\r\n        variant: 'danger',\r\n        message: `${info}, ${err.response.data.error}`,\r\n      })\r\n    } else if (err.request) {\r\n      setCategoriesError({\r\n        variant: 'danger',\r\n        message: `${info},  Không có phản hồi từ máy chủ!`,\r\n      })\r\n    } else {\r\n      setCategoriesError({ variant: 'danger', message: err.message })\r\n    }\r\n    setCategoriesLoading(false)\r\n  }\r\n\r\n  // Add new category\r\n  const addCategory = async title => {\r\n    const categoryBody = clean({ title })\r\n    console.log(categoryBody, ' categoryBody')\r\n    try {\r\n      const userToken = JSON.parse(localStorage.getItem('userToken'))\r\n      const headers = {\r\n        Authorization: `Bearer ${userToken && userToken}`,\r\n      }\r\n      setCategoriesLoading(true)\r\n      await axios.post('api/category/add', categoryBody, { headers })\r\n      // setCategories([...categories, categoryBody])\r\n      setCategoriesMessage({\r\n        variant: 'success',\r\n        message: 'Danh mục được thêm thành công!',\r\n      })\r\n      window.location.reload()\r\n      setCategoriesLoading(false)\r\n      setCategoriesError(null)\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n\r\n  // get all categories\r\n  const getCategories = async () => {\r\n    try {\r\n      setCategoriesLoading(true)\r\n      const { data } = await axios.get('api/category/getAll')\r\n      setCategories(data.categories)\r\n      setCategoriesLoading(false)\r\n      setCategoriesError(null)\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n  \r\n// Delete Category\r\nconst deleteCategory = async id  => {\r\n  try {\r\n    setCategoriesLoading(true)\r\n    const userToken = JSON.parse(localStorage.getItem('userToken'))\r\n    const headers = {\r\n      Authorization: `Bearer ${userToken && userToken}`,\r\n      'Content-Type': 'multipart/form-data',\r\n    }\r\n    const { data } = await axios.delete(`/api/category/${id}`, { headers })\r\n    setCategoriesMessage({\r\n      variant: 'success',\r\n      message: 'Xóa thành công!',\r\n    })\r\n    window.location.reload();\r\n    setCategoriesLoading(false)\r\n    setCategoriesError(null)\r\n    return data.categories\r\n  } catch (err) {\r\n    errorHandler(err, 'Không tìm thấy sản phẩm')\r\n  }\r\n}\r\n\r\n  // get one category\r\n  const getOneCategory = async id => {\r\n    try {\r\n      const { data } = await axios.get(`/api/category/${id}`)\r\n      return data.categories\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n\r\n  const updateCategory = async (id, title) => {\r\n    try {\r\n      const userToken = JSON.parse(localStorage.getItem('userToken'))\r\n      const headers = {\r\n        Authorization: `Bearer ${userToken && userToken}`,\r\n      }\r\n      setCategoriesLoading(true)\r\n      await axios.patch(`api/category/${id}`, { title }, { headers })\r\n      getCategories()\r\n      setCategoriesMessage({\r\n        variant: 'info',\r\n        message: 'Danh mục được cập nhật!',\r\n      })\r\n      setCategoriesLoading(false)\r\n      setCategoriesError(null)\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <CategoryContext.Provider\r\n      value={{\r\n        categories,\r\n        categoriesError,\r\n        categoriesLoading,\r\n        categoriesMessage,\r\n        getCategories,\r\n        addCategory,\r\n        deleteCategory,\r\n        getOneCategory,\r\n        updateCategory,\r\n      }}>\r\n      {props.children}\r\n    </CategoryContext.Provider>\r\n  )\r\n}\r\n\r\nexport default CategoryState\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}