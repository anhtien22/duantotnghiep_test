{"ast":null,"code":"import _toConsumableArray from\"D:/D\\u1EF1 \\xC1n T\\u1ED1t Nghi\\u1EC7p/duantotnghiep_test/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"D:/D\\u1EF1 \\xC1n T\\u1ED1t Nghi\\u1EC7p/duantotnghiep_test/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/D\\u1EF1 \\xC1n T\\u1ED1t Nghi\\u1EC7p/duantotnghiep_test/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:/D\\u1EF1 \\xC1n T\\u1ED1t Nghi\\u1EC7p/duantotnghiep_test/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState}from'react';import BrandContext from'./brandContext';import axios from'axios';// Function for cleaning null, undefined and empty strings values in objects\nimport{jsx as _jsx}from\"react/jsx-runtime\";function clean(obj){for(var propName in obj){if(obj[propName]===null||obj[propName]===undefined||obj[propName]===''){delete obj[propName];}}return obj;}// ------------------------------------------\n// Category State\n// ------------------------------------------\nvar BrandState=function BrandState(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),brands=_useState2[0],setBrands=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),brandsError=_useState4[0],setBrandsError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),brandsLoading=_useState6[0],setBrandsLoading=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),brandsMessage=_useState8[0],setBrandsMessage=_useState8[1];useEffect(function(){setTimeout(function(){setBrandsError(null);setBrandsMessage(null);},3000);},[brandsError,brandsMessage]);// Error Handler function\nvar errorHandler=function errorHandler(err,info){if(err.response){setBrandsError({variant:'danger',message:\"\".concat(info,\", \").concat(err.response.data.error)});}else if(err.request){setBrandsError({variant:'danger',message:\"\".concat(info,\",  Kh\\xF4ng c\\xF3 ph\\u1EA3n h\\u1ED3i t\\u1EEB m\\xE1y ch\\u1EE7!\")});}else{setBrandsError({variant:'danger',message:err.message});}setBrandsLoading(false);};// Add new category\nvar addBrand=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(local){var brandBody,userToken,headers;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:brandBody=clean({local:local});_context.prev=1;userToken=JSON.parse(localStorage.getItem('userToken'));headers={Authorization:\"Bearer \".concat(userToken&&userToken)};setBrandsLoading(true);_context.next=7;return axios.post('api/brand/add',brandBody,{headers:headers});case 7:setBrands([].concat(_toConsumableArray(brands),[brandBody]));setBrandsMessage({variant:'success',message:'Thương hiệu được thêm thành công!'});window.location.reload();setBrandsLoading(false);setBrandsError(null);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](1);errorHandler(_context.t0);case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,14]]);}));return function addBrand(_x){return _ref.apply(this,arguments);};}();// get all categories\nvar getBrands=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(limit,skip,keyword){var _yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setBrandsLoading(true);_context2.next=4;return axios.get('api/brand/getAll',{params:{limit:limit,skip:skip,keyword:keyword}});case 4:_yield$axios$get=_context2.sent;data=_yield$axios$get.data;setBrands(data.brands);setBrandsLoading(false);setBrandsError(null);_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);errorHandler(_context2.t0);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11]]);}));return function getBrands(_x2,_x3,_x4){return _ref2.apply(this,arguments);};}();// Delete Category\nvar deleteBrand=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){var userToken,headers,_yield$axios$delete,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;setBrandsLoading(true);userToken=JSON.parse(localStorage.getItem('userToken'));headers={Authorization:\"Bearer \".concat(userToken&&userToken),'Content-Type':'multipart/form-data'};_context3.next=6;return axios.delete(\"/api/brand/\".concat(id),{headers:headers});case 6:_yield$axios$delete=_context3.sent;data=_yield$axios$delete.data;setBrandsLoading(false);setBrandsError(null);setBrandsMessage({variant:'success',message:'Xóa thành công!'});window.location.reload();return _context3.abrupt(\"return\",data.categories);case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](0);errorHandler(_context3.t0,'Không tìm thấy sản phẩm');case 18:case\"end\":return _context3.stop();}}},_callee3,null,[[0,15]]);}));return function deleteBrand(_x5){return _ref3.apply(this,arguments);};}();// get one category\nvar getOneBrand=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id){var _yield$axios$get2,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return axios.get(\"/api/brand/\".concat(id));case 3:_yield$axios$get2=_context4.sent;data=_yield$axios$get2.data;return _context4.abrupt(\"return\",data.categories);case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](0);errorHandler(_context4.t0);case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[0,8]]);}));return function getOneBrand(_x6){return _ref4.apply(this,arguments);};}();var updateBrand=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(id,local){var userToken,headers;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;userToken=JSON.parse(localStorage.getItem('userToken'));headers={Authorization:\"Bearer \".concat(userToken&&userToken)};setBrandsLoading(true);_context5.next=6;return axios.patch(\"api/brand/\".concat(id),{local:local},{headers:headers});case 6:getBrands();setBrandsMessage({variant:'info',message:'Thương hiệu được cập nhật'});setBrandsLoading(false);setBrandsError(null);_context5.next=15;break;case 12:_context5.prev=12;_context5.t0=_context5[\"catch\"](0);errorHandler(_context5.t0);case 15:case\"end\":return _context5.stop();}}},_callee5,null,[[0,12]]);}));return function updateBrand(_x7,_x8){return _ref5.apply(this,arguments);};}();return/*#__PURE__*/_jsx(BrandContext.Provider,{value:{brands:brands,brandsError:brandsError,brandsLoading:brandsLoading,brandsMessage:brandsMessage,getBrands:getBrands,addBrand:addBrand,deleteBrand:deleteBrand,getOneBrand:getOneBrand,updateBrand:updateBrand},children:props.children});};export default BrandState;","map":{"version":3,"names":["React","useEffect","useState","BrandContext","axios","clean","obj","propName","undefined","BrandState","props","brands","setBrands","brandsError","setBrandsError","brandsLoading","setBrandsLoading","brandsMessage","setBrandsMessage","setTimeout","errorHandler","err","info","response","variant","message","data","error","request","addBrand","local","brandBody","userToken","JSON","parse","localStorage","getItem","headers","Authorization","post","window","location","reload","getBrands","limit","skip","keyword","get","params","deleteBrand","id","delete","categories","getOneBrand","updateBrand","patch","children"],"sources":["D:/Dự Án Tốt Nghiệp/duantotnghiep_test/frontend/src/context/brand/BrandState.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport BrandContext from './brandContext'\r\nimport axios from 'axios'\r\n\r\n\r\n// Function for cleaning null, undefined and empty strings values in objects\r\nfunction clean(obj) {\r\n  for (var propName in obj) {\r\n    if (\r\n      obj[propName] === null ||\r\n      obj[propName] === undefined ||\r\n      obj[propName] === ''\r\n    ) {\r\n      delete obj[propName]\r\n    }\r\n  }\r\n  return obj\r\n}\r\n\r\n// ------------------------------------------\r\n// Category State\r\n// ------------------------------------------\r\nconst BrandState = props => {\r\n  const [brands, setBrands] = useState([])\r\n  const [brandsError, setBrandsError] = useState(null)\r\n  const [brandsLoading, setBrandsLoading] = useState(false)\r\n  const [brandsMessage, setBrandsMessage] = useState(null)\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n        setBrandsError(null)\r\n        setBrandsMessage(null)\r\n    }, 3000)\r\n  }, [brandsError, brandsMessage])\r\n\r\n  // Error Handler function\r\n  const errorHandler = (err, info) => {\r\n    if (err.response) {\r\n        setBrandsError({\r\n        variant: 'danger',\r\n        message: `${info}, ${err.response.data.error}`,\r\n      })\r\n    } else if (err.request) {\r\n        setBrandsError({\r\n        variant: 'danger',\r\n        message: `${info},  Không có phản hồi từ máy chủ!`,\r\n      })\r\n    } else {\r\n        setBrandsError({ variant: 'danger', message: err.message })\r\n    }\r\n    setBrandsLoading(false)\r\n  }\r\n\r\n  // Add new category\r\n  const addBrand = async local => {\r\n    const brandBody = clean({ local })\r\n    try {\r\n      const userToken = JSON.parse(localStorage.getItem('userToken'))\r\n      const headers = {\r\n        Authorization: `Bearer ${userToken && userToken}`,\r\n      }\r\n      setBrandsLoading(true)\r\n      await axios.post('api/brand/add', brandBody, { headers })\r\n      setBrands([...brands, brandBody])\r\n      setBrandsMessage({\r\n        variant: 'success',\r\n        message: 'Thương hiệu được thêm thành công!',\r\n      })\r\n      window.location.reload();\r\n      setBrandsLoading(false)\r\n      setBrandsError(null)\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n\r\n  // get all categories\r\n  const getBrands = async (limit, skip, keyword) => {\r\n    try {\r\n        setBrandsLoading(true)\r\n      const { data } = await axios.get('api/brand/getAll', {\r\n        params: { limit, skip, keyword},\r\n      })\r\n      setBrands(data.brands)\r\n      setBrandsLoading(false)\r\n      setBrandsError(null)\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n\r\n// Delete Category\r\nconst deleteBrand = async id  => {\r\n  try {\r\n    setBrandsLoading(true)\r\n    const userToken = JSON.parse(localStorage.getItem('userToken'))\r\n    const headers = {\r\n      Authorization: `Bearer ${userToken && userToken}`,\r\n      'Content-Type': 'multipart/form-data',\r\n    }\r\n    const { data } = await axios.delete(`/api/brand/${id}`, { headers })\r\n    setBrandsLoading(false)\r\n    setBrandsError(null)\r\n    setBrandsMessage({\r\n      variant: 'success',\r\n      message: 'Xóa thành công!',\r\n    })\r\n    window.location.reload();\r\n    return data.categories\r\n  } catch (err) {\r\n    errorHandler(err, 'Không tìm thấy sản phẩm')\r\n  }\r\n}\r\n\r\n  // get one category\r\n  const getOneBrand = async id => {\r\n    try {\r\n      const { data } = await axios.get(`/api/brand/${id}`)\r\n      return data.categories\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n\r\n  const updateBrand = async (id, local) => {\r\n    try {\r\n      const userToken = JSON.parse(localStorage.getItem('userToken'))\r\n      const headers = {\r\n        Authorization: `Bearer ${userToken && userToken}`,\r\n      }\r\n      setBrandsLoading(true)\r\n      await axios.patch(`api/brand/${id}`, { local }, { headers })\r\n      getBrands()\r\n      setBrandsMessage({\r\n        variant: 'info',\r\n        message: 'Thương hiệu được cập nhật',\r\n      })\r\n      setBrandsLoading(false)\r\n      setBrandsError(null)\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <BrandContext.Provider\r\n      value={{\r\n        brands,\r\n        brandsError,\r\n        brandsLoading,\r\n        brandsMessage,\r\n        getBrands,\r\n        addBrand,\r\n        deleteBrand,\r\n        getOneBrand,\r\n        updateBrand,\r\n      }}>\r\n      {props.children}\r\n    </BrandContext.Provider>\r\n  )\r\n}\r\n\r\nexport default BrandState\r\n"],"mappings":"umBAAA,MAAOA,MAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAOC,aAAY,KAAM,gBAAgB,CACzC,MAAOC,MAAK,KAAM,OAAO,CAGzB;AAAA,2CACA,QAASC,MAAK,CAACC,GAAG,CAAE,CAClB,IAAK,GAAIC,SAAQ,GAAID,IAAG,CAAE,CACxB,GACEA,GAAG,CAACC,QAAQ,CAAC,GAAK,IAAI,EACtBD,GAAG,CAACC,QAAQ,CAAC,GAAKC,SAAS,EAC3BF,GAAG,CAACC,QAAQ,CAAC,GAAK,EAAE,CACpB,CACA,MAAOD,IAAG,CAACC,QAAQ,CAAC,CACtB,CACF,CACA,MAAOD,IAAG,CACZ,CAEA;AACA;AACA;AACA,GAAMG,WAAU,CAAG,QAAbA,WAAU,CAAGC,KAAK,CAAI,CAC1B,cAA4BR,QAAQ,CAAC,EAAE,CAAC,wCAAjCS,MAAM,eAAEC,SAAS,eACxB,eAAsCV,QAAQ,CAAC,IAAI,CAAC,yCAA7CW,WAAW,eAAEC,cAAc,eAClC,eAA0CZ,QAAQ,CAAC,KAAK,CAAC,yCAAlDa,aAAa,eAAEC,gBAAgB,eACtC,eAA0Cd,QAAQ,CAAC,IAAI,CAAC,yCAAjDe,aAAa,eAAEC,gBAAgB,eAEtCjB,SAAS,CAAC,UAAM,CACdkB,UAAU,CAAC,UAAM,CACbL,cAAc,CAAC,IAAI,CAAC,CACpBI,gBAAgB,CAAC,IAAI,CAAC,CAC1B,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAAE,CAACL,WAAW,CAAEI,aAAa,CAAC,CAAC,CAEhC;AACA,GAAMG,aAAY,CAAG,QAAfA,aAAY,CAAIC,GAAG,CAAEC,IAAI,CAAK,CAClC,GAAID,GAAG,CAACE,QAAQ,CAAE,CACdT,cAAc,CAAC,CACfU,OAAO,CAAE,QAAQ,CACjBC,OAAO,WAAKH,IAAI,cAAKD,GAAG,CAACE,QAAQ,CAACG,IAAI,CAACC,KAAK,CAC9C,CAAC,CAAC,CACJ,CAAC,IAAM,IAAIN,GAAG,CAACO,OAAO,CAAE,CACpBd,cAAc,CAAC,CACfU,OAAO,CAAE,QAAQ,CACjBC,OAAO,WAAKH,IAAI,iEAClB,CAAC,CAAC,CACJ,CAAC,IAAM,CACHR,cAAc,CAAC,CAAEU,OAAO,CAAE,QAAQ,CAAEC,OAAO,CAAEJ,GAAG,CAACI,OAAQ,CAAC,CAAC,CAC/D,CACAT,gBAAgB,CAAC,KAAK,CAAC,CACzB,CAAC,CAED;AACA,GAAMa,SAAQ,0FAAG,iBAAMC,KAAK,kJACpBC,SAAS,CAAG1B,KAAK,CAAC,CAAEyB,KAAK,CAALA,KAAM,CAAC,CAAC,iBAE1BE,SAAS,CAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAAC,CACzDC,OAAO,CAAG,CACdC,aAAa,kBAAYN,SAAS,EAAIA,SAAS,CACjD,CAAC,CACDhB,gBAAgB,CAAC,IAAI,CAAC,uBAChBZ,MAAK,CAACmC,IAAI,CAAC,eAAe,CAAER,SAAS,CAAE,CAAEM,OAAO,CAAPA,OAAQ,CAAC,CAAC,QACzDzB,SAAS,8BAAKD,MAAM,GAAEoB,SAAS,GAAE,CACjCb,gBAAgB,CAAC,CACfM,OAAO,CAAE,SAAS,CAClBC,OAAO,CAAE,mCACX,CAAC,CAAC,CACFe,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE,CACxB1B,gBAAgB,CAAC,KAAK,CAAC,CACvBF,cAAc,CAAC,IAAI,CAAC,kFAEpBM,YAAY,aAAK,sEAEpB,kBApBKS,SAAQ,4CAoBb,CAED;AACA,GAAMc,UAAS,2FAAG,kBAAOC,KAAK,CAAEC,IAAI,CAAEC,OAAO,iKAEvC9B,gBAAgB,CAAC,IAAI,CAAC,wBACDZ,MAAK,CAAC2C,GAAG,CAAC,kBAAkB,CAAE,CACnDC,MAAM,CAAE,CAAEJ,KAAK,CAALA,KAAK,CAAEC,IAAI,CAAJA,IAAI,CAAEC,OAAO,CAAPA,OAAO,CAChC,CAAC,CAAC,wCAFMpB,IAAI,kBAAJA,IAAI,CAGZd,SAAS,CAACc,IAAI,CAACf,MAAM,CAAC,CACtBK,gBAAgB,CAAC,KAAK,CAAC,CACvBF,cAAc,CAAC,IAAI,CAAC,sFAEpBM,YAAY,cAAK,wEAEpB,kBAZKuB,UAAS,sDAYd,CAEH;AACA,GAAMM,YAAW,2FAAG,kBAAMC,EAAE,sLAExBlC,gBAAgB,CAAC,IAAI,CAAC,CAChBgB,SAAS,CAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAAC,CACzDC,OAAO,CAAG,CACdC,aAAa,kBAAYN,SAAS,EAAIA,SAAS,CAAE,CACjD,cAAc,CAAE,qBAClB,CAAC,wBACsB5B,MAAK,CAAC+C,MAAM,sBAAeD,EAAE,EAAI,CAAEb,OAAO,CAAPA,OAAQ,CAAC,CAAC,2CAA5DX,IAAI,qBAAJA,IAAI,CACZV,gBAAgB,CAAC,KAAK,CAAC,CACvBF,cAAc,CAAC,IAAI,CAAC,CACpBI,gBAAgB,CAAC,CACfM,OAAO,CAAE,SAAS,CAClBC,OAAO,CAAE,iBACX,CAAC,CAAC,CACFe,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE,CAAC,iCAClBhB,IAAI,CAAC0B,UAAU,+DAEtBhC,YAAY,cAAM,yBAAyB,CAAC,wEAE/C,kBApBK6B,YAAW,8CAoBhB,CAEC;AACA,GAAMI,YAAW,2FAAG,kBAAMH,EAAE,yLAED9C,MAAK,CAAC2C,GAAG,sBAAeG,EAAE,EAAG,yCAA5CxB,IAAI,mBAAJA,IAAI,kCACLA,IAAI,CAAC0B,UAAU,6DAEtBhC,YAAY,cAAK,uEAEpB,kBAPKiC,YAAW,8CAOhB,CAED,GAAMC,YAAW,2FAAG,kBAAOJ,EAAE,CAAEpB,KAAK,6JAE1BE,SAAS,CAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAAC,CACzDC,OAAO,CAAG,CACdC,aAAa,kBAAYN,SAAS,EAAIA,SAAS,CACjD,CAAC,CACDhB,gBAAgB,CAAC,IAAI,CAAC,wBAChBZ,MAAK,CAACmD,KAAK,qBAAcL,EAAE,EAAI,CAAEpB,KAAK,CAALA,KAAM,CAAC,CAAE,CAAEO,OAAO,CAAPA,OAAQ,CAAC,CAAC,QAC5DM,SAAS,EAAE,CACXzB,gBAAgB,CAAC,CACfM,OAAO,CAAE,MAAM,CACfC,OAAO,CAAE,2BACX,CAAC,CAAC,CACFT,gBAAgB,CAAC,KAAK,CAAC,CACvBF,cAAc,CAAC,IAAI,CAAC,sFAEpBM,YAAY,cAAK,wEAEpB,kBAlBKkC,YAAW,kDAkBhB,CAED,mBACE,KAAC,YAAY,CAAC,QAAQ,EACpB,KAAK,CAAE,CACL3C,MAAM,CAANA,MAAM,CACNE,WAAW,CAAXA,WAAW,CACXE,aAAa,CAAbA,aAAa,CACbE,aAAa,CAAbA,aAAa,CACb0B,SAAS,CAATA,SAAS,CACTd,QAAQ,CAARA,QAAQ,CACRoB,WAAW,CAAXA,WAAW,CACXI,WAAW,CAAXA,WAAW,CACXC,WAAW,CAAXA,WACF,CAAE,UACD5C,KAAK,CAAC8C,QAAQ,EACO,CAE5B,CAAC,CAED,cAAe/C,WAAU"},"metadata":{},"sourceType":"module"}