{"ast":null,"code":"import _toConsumableArray from\"D:/D\\u1EF1 \\xC1n T\\u1ED1t Nghi\\u1EC7p/duantotnghiep_test/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"D:/D\\u1EF1 \\xC1n T\\u1ED1t Nghi\\u1EC7p/duantotnghiep_test/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/D\\u1EF1 \\xC1n T\\u1ED1t Nghi\\u1EC7p/duantotnghiep_test/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:/D\\u1EF1 \\xC1n T\\u1ED1t Nghi\\u1EC7p/duantotnghiep_test/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState}from'react';import VariationContext from'./variationContext';import axios from'axios';// Function for cleaning null, undefined and empty strings values in objects\nimport{jsx as _jsx}from\"react/jsx-runtime\";function clean(obj){for(var propName in obj){if(obj[propName]===null||obj[propName]===undefined||obj[propName]===''){delete obj[propName];}}return obj;}// ------------------------------------------\n// Category State\n// ------------------------------------------\nvar VariationState=function VariationState(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),variation=_useState2[0],setVariations=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),variationsError=_useState4[0],setVariationsError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),variationsLoading=_useState6[0],setVariationsLoading=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),variationsMessage=_useState8[0],setVariationsMessage=_useState8[1];useEffect(function(){setTimeout(function(){setVariationsError(null);setVariationsMessage(null);},3000);},[variationsError,variationsMessage]);// Error Handler function\nvar errorHandler=function errorHandler(err,info){if(err.response){setVariationsError({variant:'danger',message:\"\".concat(info,\", \").concat(err.response.data.error)});}else if(err.request){setVariationsError({variant:'danger',message:\"\".concat(info,\",  No response from server!\")});}else{setVariationsError({variant:'danger',message:err.message});}setVariationsLoading(false);};// Add new variation\nvar addVariation=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(title){var variationBody,userToken,headers;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:variationBody=clean({title:title});_context.prev=1;userToken=JSON.parse(localStorage.getItem('userToken'));headers={Authorization:\"Bearer \".concat(userToken&&userToken)};setVariationsLoading(true);_context.next=7;return axios.post('api/variation/add',variationBody,{headers:headers});case 7:setVariations([].concat(_toConsumableArray(variation),[variationBody]));setVariationsMessage({variant:'success',message:'variation added successfully!'});setVariationsLoading(false);setVariationsError(null);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);errorHandler(_context.t0);case 16:case\"end\":return _context.stop();}}},_callee,null,[[1,13]]);}));return function addVariation(_x){return _ref.apply(this,arguments);};}();// get all variation\nvar getVariations=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setVariationsLoading(true);_context2.next=4;return axios.get('api/variation/getAll');case 4:_yield$axios$get=_context2.sent;data=_yield$axios$get.data;setVariations(data.variation);setVariationsLoading(false);setVariationsError(null);_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);errorHandler(_context2.t0);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11]]);}));return function getVariations(){return _ref2.apply(this,arguments);};}();// get one variation\nvar getOneVariation=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){var _yield$axios$get2,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.get(\"/api/variation/\".concat(id));case 3:_yield$axios$get2=_context3.sent;data=_yield$axios$get2.data;return _context3.abrupt(\"return\",data.variation);case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);errorHandler(_context3.t0);case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);}));return function getOneVariation(_x2){return _ref3.apply(this,arguments);};}();var updateVariation=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id,title){var userToken,headers;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;userToken=JSON.parse(localStorage.getItem('userToken'));headers={Authorization:\"Bearer \".concat(userToken&&userToken)};setVariationsLoading(true);_context4.next=6;return axios.patch(\"api/variation/\".concat(id),{title:title},{headers:headers});case 6:getVariations();setVariationsMessage({variant:'info',message:'Category updated!'});setVariationsLoading(false);setVariationsError(null);_context4.next=15;break;case 12:_context4.prev=12;_context4.t0=_context4[\"catch\"](0);errorHandler(_context4.t0);case 15:case\"end\":return _context4.stop();}}},_callee4,null,[[0,12]]);}));return function updateVariation(_x3,_x4){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsx(VariationContext.Provider,{value:{variation:variation,variationsError:variationsError,variationsLoading:variationsLoading,variationsMessage:variationsMessage,getVariations:getVariations,addVariation:addVariation,getOneVariation:getOneVariation,updateVariation:updateVariation},children:props.children});};export default VariationState;","map":{"version":3,"names":["React","useEffect","useState","VariationContext","axios","clean","obj","propName","undefined","VariationState","props","variation","setVariations","variationsError","setVariationsError","variationsLoading","setVariationsLoading","variationsMessage","setVariationsMessage","setTimeout","errorHandler","err","info","response","variant","message","data","error","request","addVariation","title","variationBody","userToken","JSON","parse","localStorage","getItem","headers","Authorization","post","getVariations","get","getOneVariation","id","updateVariation","patch","children"],"sources":["D:/Dự Án Tốt Nghiệp/duantotnghiep_test/frontend/src/context/variation/VariationState.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport VariationContext from './variationContext'\r\nimport axios from 'axios'\r\n\r\n// Function for cleaning null, undefined and empty strings values in objects\r\nfunction clean(obj) {\r\n  for (var propName in obj) {\r\n    if (\r\n      obj[propName] === null ||\r\n      obj[propName] === undefined ||\r\n      obj[propName] === ''\r\n    ) {\r\n      delete obj[propName]\r\n    }\r\n  }\r\n  return obj\r\n}\r\n\r\n// ------------------------------------------\r\n// Category State\r\n// ------------------------------------------\r\nconst VariationState = props => {\r\n  const [variation, setVariations] = useState([])\r\n  const [variationsError, setVariationsError] = useState(null)\r\n  const [variationsLoading, setVariationsLoading] = useState(false)\r\n  const [variationsMessage, setVariationsMessage] = useState(null)\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      setVariationsError(null)\r\n      setVariationsMessage(null)\r\n    }, 3000)\r\n  }, [variationsError, variationsMessage])\r\n\r\n  // Error Handler function\r\n  const errorHandler = (err, info) => {\r\n    if (err.response) {\r\n      setVariationsError({\r\n        variant: 'danger',\r\n        message: `${info}, ${err.response.data.error}`,\r\n      })\r\n    } else if (err.request) {\r\n      setVariationsError({\r\n        variant: 'danger',\r\n        message: `${info},  No response from server!`,\r\n      })\r\n    } else {\r\n      setVariationsError({ variant: 'danger', message: err.message })\r\n    }\r\n    setVariationsLoading(false)\r\n  }\r\n\r\n  // Add new variation\r\n  const addVariation = async title => {\r\n    const variationBody = clean({ title })\r\n    try {\r\n      const userToken = JSON.parse(localStorage.getItem('userToken'))\r\n      const headers = {\r\n        Authorization: `Bearer ${userToken && userToken}`,\r\n      }\r\n      setVariationsLoading(true)\r\n      await axios.post('api/variation/add', variationBody, { headers })\r\n      setVariations([...variation, variationBody])\r\n      setVariationsMessage({\r\n        variant: 'success',\r\n        message: 'variation added successfully!',\r\n      })\r\n      setVariationsLoading(false)\r\n      setVariationsError(null)\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n\r\n  // get all variation\r\n  const getVariations = async () => {\r\n    try {\r\n      setVariationsLoading(true)\r\n      const { data } = await axios.get('api/variation/getAll')\r\n      setVariations(data.variation)\r\n      setVariationsLoading(false)\r\n      setVariationsError(null)\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n\r\n  // get one variation\r\n  const getOneVariation = async id => {\r\n    try {\r\n      const { data } = await axios.get(`/api/variation/${id}`)\r\n      return data.variation\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n\r\n  const updateVariation = async (id, title) => {\r\n    try {\r\n      const userToken = JSON.parse(localStorage.getItem('userToken'))\r\n      const headers = {\r\n        Authorization: `Bearer ${userToken && userToken}`,\r\n      }\r\n      setVariationsLoading(true)\r\n      await axios.patch(`api/variation/${id}`, { title }, { headers })\r\n      getVariations()\r\n      setVariationsMessage({\r\n        variant: 'info',\r\n        message: 'Category updated!',\r\n      })\r\n      setVariationsLoading(false)\r\n      setVariationsError(null)\r\n    } catch (err) {\r\n      errorHandler(err)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <VariationContext.Provider\r\n      value={ {\r\n        variation,\r\n        variationsError,\r\n        variationsLoading,\r\n        variationsMessage,\r\n        getVariations,\r\n        addVariation,\r\n        getOneVariation,\r\n        updateVariation,\r\n      } }>\r\n      { props.children }\r\n    </VariationContext.Provider>\r\n  )\r\n}\r\n\r\nexport default VariationState\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}